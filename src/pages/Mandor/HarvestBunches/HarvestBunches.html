<ion-header>
  <ion-navbar>
    <ion-title>{{ "_TITLE" | translate }} - {{ "_HARVEST_BUNCHES_HEADER" | translate }}</ion-title>
  </ion-navbar>
</ion-header>

<ion-content>
  <ion-card class="cards-list-demo" *ngFor="let location of locationFromDB">
    <ion-card-header>
      {{ "_LOCATION_LBL" | translate }} : {{location.location_name}}
      <ion-segment [(ngModel)]="location.h1" color="secondary">
        <ion-segment-button value="seg_info">
          {{"_INFO_LBL" | translate }}
        </ion-segment-button>
        <ion-segment-button value="seg_harvest">
          {{"_HARVEST_LBL" | translate }}
        </ion-segment-button>
        <ion-segment-button value="seg_load">
          {{"_LOAD_LBL" | translate }}
        </ion-segment-button>
      </ion-segment>
    </ion-card-header>
    <div [ngSwitch]="location.h1">
      <ion-card *ngSwitchDefault>
        <ion-label>{{ "_TOTAL_HARVESTED_LBL" | translate }}: </ion-label>
        <ion-label>{{ "_LOADED_LBL" | translate }} : </ion-label>
        <ion-label>{{ "_BALANCE_LBL" | translate }} : </ion-label>
      </ion-card>
      <ion-card *ngSwitchCase="'seg_harvest'">
        <ion-card-content>
          <form [formGroup]="harvestAuthForm" (ngSubmit)="submitHarvestForm(harvestAuthForm.value,location.location_GUID)">
            <ion-item>
              <ion-label fixed>{{ "_TOTAL_BUNCHES_LBL" | translate }}</ion-label>
              <ion-input formControlName="harvestedBunchCount" highlight-color="energized" type="text" value=""></ion-input>
            </ion-item>
            <button type="submit" ion-button full [disabled]="!harvestAuthForm.valid">{{ "_SUBMIT_BTN" | translate }}</button>
            <div class="error-box" *ngIf="harvestAuthForm.controls['harvestedBunchCount'].hasError('required') ">{{ "_BUNCH_COUNT_VLD" | translate }}</div>
          </form>


        </ion-card-content>
      </ion-card>
      <ion-card *ngSwitchCase="'seg_load'">
        <ion-card-content>
          <form [formGroup]="loadAuthForm" (ngSubmit)="submitLoadForm(loadAuthForm.value,location.location_GUID)">
            <ion-item>
              <ion-label>{{"_VEHICLE_NO_LBL" | translate}}</ion-label>
              <ion-select formControlName="vehicleSelect" [(ngModel)]="vehicleSelect" interface="popover" placeholder='{{"_SELECT_VEHICLE_HINT" | translate}}'>
                <ion-option *ngFor="let vehicle of vehicleFromDB" value={{vehicle.vehicle_GUID}}>{{vehicle.registration_no}}</ion-option>
              </ion-select>
            </ion-item>
            <ion-item>
              <ion-label>{{"_DRIVER_LBL" | translate}}</ion-label>
              <ion-select formControlName="driverSelect" [(ngModel)]="driverSelect" interface="popover" placeholder='{{"_SELECT_DRIVER_HINT" | translate}}'>
                <ion-option *ngFor="let driver of driverFromDB" value={{driver.driver_GUID}}>{{driver.fullname}}</ion-option>
              </ion-select>
            </ion-item>
            <ion-item>
              <ion-label fixed>{{ "_TOTAL_BUNCHES_LBL" | translate }}</ion-label>
              <ion-input formControlName="loadedBunchCount" highlight-color="energized" type="text" value=""></ion-input>
            </ion-item>
            <button type="submit" ion-button full [disabled]="!loadAuthForm.valid">{{ "_SUBMIT_BTN" | translate }}</button>
            <div class="error-box" *ngIf="loadAuthForm.controls['vehicleSelect'].hasError('required') ">{{ "_VEHICLE_SELECT_VLD" | translate }}</div>
            <div class="error-box" *ngIf="loadAuthForm.controls['driverSelect'].hasError('required') ">{{ "_DRIVER_SELECT_VLD" | translate }}</div>
            <div class="error-box" *ngIf="loadAuthForm.controls['loadedBunchCount'].hasError('required') ">{{ "_BUNCH_COUNT_VLD" | translate }}</div>
          </form>
        </ion-card-content>
      </ion-card>
    </div>

    <ion-list>
    </ion-list>
  </ion-card>
</ion-content>